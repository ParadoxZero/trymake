<!--
*   Author: Bineeth (bineeth@trymake.com)
*
*   Copyright (c) 2017 Sibibia Technologies Pvt Ltd
*   All Rights Reserved
*
*   Unauthorized copying of this file, via any medium is strictly prohibited
*   Proprietary and confidential
-->
{% extends 'website/core/base-includes.html' %}
{% load staticfiles %}
{% block title %}
    <title>
        My-account | Trymake
    </title>
{% endblock %}
{% block head %}
    <script src="{% static 'website/core/my-account.js' %}"></script>
    <script src="{% static 'website/core/angular-ng-html-bind.js' %}"></script>
    <script src="{% static 'website/core/angular ui.js' %}"></script>
    <link rel="stylesheet" href="{% static 'website/core/css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'website/core/css/my-account.css' %}">
{% endblock %}

{% block body %}
    <body ng-app="my_account" ng-controller="account_details" ng-cloak>
        <div ng-show="status==='error'">
            <span>Error:</span>{[error_message]}
        </div>
        <div class="customer">
            <h2>Customer details</h2>
            <span>Name:</span>
            <span ng-hide="customer_current_name">
                {{ customer.name }}
            </span>
            <span ng-show="customer_current_name">
                    {[customer_current_name]}
            </span><br>
            <span>Email:</span><span>{{ customer.user.email }}</span><br>
            <span>Phone no:</span><span ng-init="customer_current_phone={{ customer.phone }}">{[customer_current_phone]}</span><br>
            <div id="update-profile">
                <form ng-click="update_profile_form()">
                    {% csrf_token %}
                    <a href="#">Update profile</a>
                </form>
                <form ng-submit="update_profile_submit()" ng-show="form">
                    <table bind-html-compile="form"> </table>
                        {% csrf_token %}
                        <input type="submit">
                </form>
            </div>
            <div id="address">
                <!-- Can change to automatic call in future -->
                <button ng-click="show_address_list()">Show address list</button>
                <!-------------------------------------------->
                <button ng-click="add_new_address();">Add new address</button>
                <form ng-submit="process_address_add()" ng-show="!show_add_list && !edit_add && add_new_add">
                    <div bind-html-compile="form_add_address"></div>
                    <input type="submit" ng-show="form_add_address">
                </form>
                <form ng-submit="submit_edit_address()" ng-show="!show_add_list && edit_add && !add_new_add">
                    <div bind-html-compile="form_edit_address"></div>
                    <input type="submit" ng-show="form_edit_address">
                </form>
                <div class="address-list" ng-show="show_add_list">
                    <div class="panel-group" id="accordion">
                        <div class="address" ng-repeat="address in address_list">
                            <div class="panel panel-default">
                                 <div class="panel-heading">
                                    <h4 class="panel-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapse{[$index + 1]}">{[address.name]}</a>
                                    </h4>
                                     <button ng-click="get_edit_address(address)">Edit address</button>
                                 </div>
                                <div id="collapse{[$index + 1]}" class="panel-collapse collapse in">
                                    <div class="panel-body">
                                        <span>Name: </span> {[address.name]}<br>
                                        <span>Address: </span>{[address.address]}<br>
                                        <span>Landmark: </span>{[address.landmark]}<br>
                                        <span>City: </span>{[address.city]}<br>
                                        <span>Pincode: </span>{[address.pincode]}<br>
                                        <span>State: </span>{[address.state]}<br>
                                        <span>Phone no.: </span>{[address.phone]}<br>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="orders"  ng-init="get_list = {
                'n' : 5,
                'complete' : false,
                'canceled' : false,
                'chunk_number' : 0
            }">
            <h2>Your orders</h2>
            <button ng-click="view_orders(get_list) ;
                get_list['chunk_number'] = get_list['chunk_number']+1">
                Recent orders {[get_list['chunk_number']]}
            </button>
            <button ng-click="get_list['n'] = 50 ;
            view_orders(get_list_all)"> View all orders {[get_list['n']]}</button>
            <br>{[return_list]}
            <div ng-show="!return_list">

                {{ orders }}
            </div>
        </div>
        <div class="complaints">
            <h2>Complaints</h2>
            {{ complaints }}
        </div>
    </body>
{% endblock %}

