<!--
*   Author: Bineeth (bineeth@trymake.com)
*
*   Copyright (c) 2017 Sibibia Technologies Pvt Ltd
*   All Rights Reserved
*
*   Unauthorized copying of this file, via any medium is strictly prohibited
*   Proprietary and confidential
-->
{% extends 'website/core/base-includes.html' %}
{% load staticfiles %}
{% block title %}
    <title>
        My-account | Trymake
    </title>
{% endblock %}
{% block head %}
    <link rel="stylesheet" href="{% static 'website/core/css/my-account.css' %}">
    <script src="{% static 'website/core/my-account.js' %}"></script>
    <script src="{% static 'website/core/angular-ng-html-bind.js' %}"></script>
    <script src="{% static 'website/core/angular-ngSanitize.js' %}"></script>
{% endblock %}

{% block body %}
    <body ng-app="my_account" ng-controller="account_details" ng-cloak>
        <div class="customer">
            <h2>Customer details</h2>
            <span>Name:</span>
            <span ng-hide="customer_current_name">
                {{ customer.name }}
            </span>
            <span ng-show="name" ng-init="customer_current_name={{ customer.name }}">
                    {[customer_current_name]}
            </span><br>
            <span>Email:</span><span>{{ customer.user.email }}</span><br>
            <span>Phone no:</span><span ng-init="customer_current_phone={{ customer.phone }}">{[customer_current_phone]}</span><br>
            <div id="update-profile">
                <form ng-click="update_profile_form()">
                    {% csrf_token %}
                    <a href="#">Update profile</a>
                </form>
                <form ng-submit="update_profile_submit()" ng-show="form">
                    <table bind-html-compile="form"> </table>
                        {% csrf_token %}
                        <input type="submit">
                        <h3 ng-hide="!status">Status : {[noError]}</h3>
                </form>
            </div>
            <div id="address">
                <!-- Can change to automatic call in future -->
                <button ng-click="show_address_list()">Show address list</button>
                <!-------------------------------------------->
                <button ng-click="add_new_edit_address()">Add new address</button>
                <form ng-submit="process_address_add()">
                    <div bind-html-compile="form_add_edit_address">

                    </div>
                    <input type="submit" ng-show="form_add_edit_address">
                </form>
                <div ng-show="status==='error'">
                    <span>Error:</span>{[error_message]}
                </div>
            </div>
        </div>
        <div class="orders"  ng-init="get_list = {
                'n' : 5,
                'complete' : false,
                'canceled' : false,
                'chunk_number' : 0
            }">
            <h2>Your orders</h2>
            <button ng-click="view_orders(get_list) ;
                get_list['chunk_number'] = get_list['chunk_number']+1">
                Recent orders {[get_list['chunk_number']]}
            </button>
            <button ng-click="get_list['n'] = 50 ;
            view_orders(get_list_all)"> View all orders {[get_list['n']]}</button>
            <br>{[return_list]}
            <div ng-show="!return_list">

                {{ orders }}
            </div>
        </div>
        <div class="complaints">
            <h2>Complaints</h2>
            {{ complaints }}
        </div>

    </body>
{% endblock %}

